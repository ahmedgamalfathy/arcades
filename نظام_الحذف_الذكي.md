# ูุธุงู ุงูุญุฐู ุงูุฐูู ููุฃุฌูุฒุฉ ูุฃููุงุน ุงูุฃุฌูุฒุฉ ูุฃููุงุช ุงูุชุดุบูู

## ุงูููุทู ุงูุฌุฏูุฏ ููุญุฐู

### 1. ุญุฐู ุงูุฃุฌูุฒุฉ (Device)

#### โ **ููุณูุญ ุจุงูุญุฐู (Soft Delete)**
- ุงูุฌูุงุฒ **ูุด ุดุบุงู** ูู ุฃู ุชูู ุญุงููุงู
- ูููุด ุญุฌูุฒุงุช ูุดุทุฉ (`status = 1`) ุนูู ุงูุฌูุงุฒ
- ูุชู ุญุฐู ุงูุฌูุงุฒ ุจู **Soft Delete** ููุท
- **ุงูุชูุงุฑูุฑ ูุด ุจุชุชุฃุซุฑ** ูุฃู ุงูุจูุงูุงุช ูุณู ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### โ **ููููุน ุงูุญุฐู**
- ุงูุฌูุงุฒ **ุดุบุงู ุญุงููุงู** ูู ุชูู (ููู ุญุฌูุฒุงุช ูุดุทุฉ)
- ุฑุณุงูุฉ ุงูุฎุทุฃ: `"ูุง ูููู ุญุฐู ุงูุฌูุงุฒ ูุฃูู ุดุบุงู ุญุงููุงู ูู ุงูุชูู (X ุญุฌุฒ ูุดุท). ูุฌุจ ุฅููุงุก ุงูุญุฌูุฒุงุช ุฃููุงู."`

### 2. ุญุฐู ุฃููุงุน ุงูุฃุฌูุฒุฉ (DeviceType)

#### โ **ููุณูุญ ุจุงูุญุฐู (Soft Delete)**
- **ุฌููุน ุงูุฃุฌูุฒุฉ** ุงูุชุงุจุนุฉ ููุฐุง ุงูููุน **ูุด ุดุบุงูุฉ** ูู ุฃู ุชูู
- ูุชู ุญุฐู ููุน ุงูุฌูุงุฒ ุจู **Soft Delete**
- ูุชู ุญุฐู **ุฌููุน ุงูุฃุฌูุฒุฉ** ุงูุชุงุจุนุฉ ูู ุจู **Soft Delete** ุชููุงุฆูุงู
- **ุงูุชูุงุฑูุฑ ูุด ุจุชุชุฃุซุฑ** ูุฃู ุงูุจูุงูุงุช ูุณู ููุฌูุฏุฉ

#### โ **ููููุน ุงูุญุฐู**
- **ุฃู ุฌูุงุฒ** ูู ุงูุฃุฌูุฒุฉ ุงูุชุงุจุนุฉ ููุฐุง ุงูููุน **ุดุบุงู ุญุงููุงู** ูู ุชูู
- ุฑุณุงูุฉ ุงูุฎุทุฃ: `"ูุง ูููู ุญุฐู ููุน ุงูุฌูุงุฒ ูุฃู X ูู ุฃุฌูุฒุชู ุดุบุงูุฉ ุญุงููุงู ูู ุงูุชูู. ูุฌุจ ุฅููุงุก ุงูุญุฌูุฒุงุช ุฃููุงู."`

### 3. ุญุฐู ุฃููุงุช ุงูุชุดุบูู (DeviceTime)

#### โ **ููุณูุญ ุจุงูุญุฐู (Soft Delete)**
- ููุช ุงูุชุดุบูู **ูุด ูุณุชุฎุฏู** ูู ุฃู ุญุฌูุฒุงุช ูุดุทุฉ ุญุงููุงู
- ูููุด ุญุฌูุฒุงุช ูุดุทุฉ (`status = 1`) ุชุณุชุฎุฏู ูุฐุง ุงูููุช
- ูุชู ุญุฐู ููุช ุงูุชุดุบูู ุจู **Soft Delete** ููุท
- **ุงูุชูุงุฑูุฑ ูุด ุจุชุชุฃุซุฑ** ูุฃู ุงูุจูุงูุงุช ูุณู ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### โ **ููููุน ุงูุญุฐู**
- ููุช ุงูุชุดุบูู **ูุณุชุฎุฏู ุญุงููุงู** ูู ุญุฌูุฒุงุช ูุดุทุฉ
- ุฑุณุงูุฉ ุงูุฎุทุฃ: `"ูุง ูููู ุญุฐู ููุช ุงูุชุดุบูู ูุฃูู ูุณุชุฎุฏู ุญุงููุงู ูู X ุญุฌุฒ ูุดุท. ูุฌุจ ุฅููุงุก ุงูุญุฌูุฒุงุช ุฃููุงู."`

## ุงูููุฏ ุงููุทุจู

### Device Model
```php
/**
 * ุงูุชุญูู ูู ูุฌูุฏ ุญุฌูุฒุงุช ูุดุทุฉ (ุดุบุงู ูู ุชูู)
 */
public function hasActiveBookings(): bool
{
    return $this->bookedDevices()
        ->where('status', 1) // ูุดุท
        ->exists();
}

/**
 * ุงูุชุญูู ูู ุฅููุงููุฉ ุญุฐู ุงูุฌูุงุฒ
 */
public function canBeDeleted(): bool
{
    // ุฅุฐุง ูุงู ุดุบุงู ูู ุชููุ ููููุนุด ูุชุญุฐู ุฎุงูุต
    if ($this->hasActiveBookings()) {
        return false;
    }
    
    // ุฅุฐุง ูุด ุดุบุงูุ ูุชุญุฐู Soft Delete
    return true;
}
```

### DeviceType Model
```php
/**
 * ุงูุชุญูู ูู ูุฌูุฏ ุฃุฌูุฒุฉ ุดุบุงูุฉ ูู ุชูู
 */
public function hasDevicesWithActiveBookings(): bool
{
    return $this->devices()
        ->whereHas('bookedDevices', function($query) {
            $query->where('status', 1); // ูุดุท
        })
        ->exists();
}

/**
 * ุงูุชุญูู ูู ุฅููุงููุฉ ุญุฐู ููุน ุงูุฌูุงุฒ
 */
public function canBeDeleted(): bool
{
    // ุฅุฐุง ููู ุฃุฌูุฒุฉ ุดุบุงูุฉ ูู ุชููุ ููููุนุด ูุชุญุฐู
    if ($this->hasDevicesWithActiveBookings()) {
        return false;
    }
    
    // ุฅุฐุง ูููุด ุฃุฌูุฒุฉ ุดุบุงูุฉุ ูุชุญุฐู Soft Delete ูู ูุงูุฃุฌูุฒุฉ
    return true;
}
```

### DeviceTime Model
```php
/**
 * ุงูุชุญูู ูู ูุฌูุฏ ุญุฌูุฒุงุช ูุดุทุฉ
 */
public function hasActiveBookings(): bool
{
    return $this->bookedDevices()
        ->where('status', 1) // ูุดุท
        ->exists();
}

/**
 * ุงูุชุญูู ูู ุฅููุงููุฉ ุญุฐู ููุช ุงูุชุดุบูู
 */
public function canBeDeleted(): bool
{
    // ุฅุฐุง ูุงู ูุณุชุฎุฏู ูู ุญุฌูุฒุงุช ูุดุทุฉุ ููููุนุด ูุชุญุฐู
    if ($this->hasActiveBookings()) {
        return false;
    }
    
    // ุฅุฐุง ูุด ูุณุชุฎุฏู ูู ุญุฌูุฒุงุช ูุดุทุฉุ ูุชุญุฐู Soft Delete
    return true;
}
```

### DeviceTypeService
```php
public function deleteDeviceType(int $id)
{
    $deviceType = DeviceType::find($id);
    
    // ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุญุฐู
    if (!$deviceType->canBeDeleted()) {
        throw new \Exception($deviceType->getDeletionBlockReason());
    }
    
    // ุญุฐู ุงูุฃุฌูุฒุฉ ุบูุฑ ุงููุดุทุฉ ุฃููุงู (Soft Delete)
    $deviceType->devices()->each(function($device) {
        if (!$device->hasActiveBookings()) {
            $device->delete(); // Soft Delete
        }
    });
    
    // ุญุฐู ููุน ุงูุฌูุงุฒ (Soft Delete)
    $deviceType->delete();
    return $deviceType;
}
```

### DeviceTimeService
```php
public function deleteDeviceTime(int $id)
{
    $deviceTime = DeviceTime::find($id);
    
    // ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุญุฐู
    if (!$deviceTime->canBeDeleted()) {
        throw new \Exception($deviceTime->getDeletionBlockReason());
    }
    
    // ุฅุฐุง ูุด ูุณุชุฎุฏู ูู ุญุฌูุฒุงุช ูุดุทุฉุ ูุชุญุฐู Soft Delete
    $deviceTime->delete();
    return $deviceTime;
}
```

## ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุณููุงุฑูู 1: ุญุฐู ุฌูุงุฒ ุบูุฑ ูุดุท
```
ุงูุฌูุงุฒ: PlayStation 5 #1
ุงูุญุงูุฉ: ูุชุงุญ (ูุด ูุญุฌูุฒ)
ุงููุชูุฌุฉ: โ ูุชู ุญุฐูู ุจู Soft Delete
ุงูุชุฃุซูุฑ ุนูู ุงูุชูุงุฑูุฑ: โ ูุง ููุฌุฏ ุชุฃุซูุฑ
```

### ุณููุงุฑูู 2: ุญุฐู ุฌูุงุฒ ูุดุท
```
ุงูุฌูุงุฒ: PlayStation 5 #2  
ุงูุญุงูุฉ: ูุญุฌูุฒ (ุดุบุงู ูู ุชูู)
ุงููุชูุฌุฉ: โ ููููุน ุงูุญุฐู
ุงูุฑุณุงูุฉ: "ูุง ูููู ุญุฐู ุงูุฌูุงุฒ ูุฃูู ุดุบุงู ุญุงููุงู ูู ุงูุชูู"
```

### ุณููุงุฑูู 3: ุญุฐู ููุน ุฌูุงุฒ (ุฌููุน ุฃุฌูุฒุชู ุบูุฑ ูุดุทุฉ)
```
ููุน ุงูุฌูุงุฒ: PlayStation 5
ุงูุฃุฌูุฒุฉ: 3 ุฃุฌูุฒุฉ (ูููุง ูุชุงุญุฉ)
ุงููุชูุฌุฉ: โ ูุชู ุญุฐู ุงูููุน ู3 ุฃุฌูุฒุฉ ุจู Soft Delete
ุงูุชุฃุซูุฑ ุนูู ุงูุชูุงุฑูุฑ: โ ูุง ููุฌุฏ ุชุฃุซูุฑ
```

### ุณููุงุฑูู 4: ุญุฐู ููุน ุฌูุงุฒ (ุจุนุถ ุฃุฌูุฒุชู ูุดุทุฉ)
```
ููุน ุงูุฌูุงุฒ: PlayStation 5
ุงูุฃุฌูุฒุฉ: 3 ุฃุฌูุฒุฉ (1 ูุญุฌูุฒุ 2 ูุชุงุญูู)
ุงููุชูุฌุฉ: โ ููููุน ุญุฐู ุงูููุน
ุงูุฑุณุงูุฉ: "ูุง ูููู ุญุฐู ููุน ุงูุฌูุงุฒ ูุฃู 1 ูู ุฃุฌูุฒุชู ุดุบุงูุฉ ุญุงููุงู ูู ุงูุชูู"
```

### ุณููุงุฑูู 5: ุญุฐู ููุช ุชุดุบูู ุบูุฑ ูุณุชุฎุฏู
```
ููุช ุงูุชุดุบูู: ุณุงุนุฉ ุจู 50 ุฌููู
ุงูุญุงูุฉ: ุบูุฑ ูุณุชุฎุฏู ูู ุฃู ุญุฌูุฒุงุช ูุดุทุฉ
ุงููุชูุฌุฉ: โ ูุชู ุญุฐูู ุจู Soft Delete
ุงูุชุฃุซูุฑ ุนูู ุงูุชูุงุฑูุฑ: โ ูุง ููุฌุฏ ุชุฃุซูุฑ
```

### ุณููุงุฑูู 6: ุญุฐู ููุช ุชุดุบูู ูุณุชุฎุฏู
```
ููุช ุงูุชุดุบูู: ุณุงุนุฉ ุจู 30 ุฌููู
ุงูุญุงูุฉ: ูุณุชุฎุฏู ูู 2 ุญุฌุฒ ูุดุท
ุงููุชูุฌุฉ: โ ููููุน ุงูุญุฐู
ุงูุฑุณุงูุฉ: "ูุง ูููู ุญุฐู ููุช ุงูุชุดุบูู ูุฃูู ูุณุชุฎุฏู ุญุงููุงู ูู 2 ุญุฌุฒ ูุดุท"
```

## ุงูููุงุฆุฏ

### 1. **ุญูุงูุฉ ุงูุจูุงูุงุช ุงููุงููุฉ**
- ุงูู Soft Delete ูุญุงูุธ ุนูู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุชูุงุฑูุฑ ุงููุงููุฉ ุชูุถู ุชุดุชุบู ุจุดูู ุทุจูุนู
- ูููุด ูุณุฑ ูู ุงูุญุณุงุจุงุช ุฃู ุงูุฅุญุตุงุฆูุงุช

### 2. **ููุน ุชุนุทูู ุงููุธุงู**
- ุงูุฃุฌูุฒุฉ ุงูุดุบุงูุฉ ูู ุงูุชูู ูุญููุฉ ูู ุงูุญุฐู
- ุงูุนููุงุก ูุด ููุชุฃุซุฑูุง ุจุญุฐู ุงูุฃุฌูุฒุฉ ุจุงูุบูุท
- ุงููุธุงู ููุถู ูุณุชูุฑ

### 3. **ูุฑููุฉ ูู ุงูุฅุฏุงุฑุฉ**
- ูููู ุญุฐู ุงูุฃุฌูุฒุฉ ุบูุฑ ุงููุณุชุฎุฏูุฉ ุจุฃูุงู
- ูููู ุงุณุชุนุงุฏุฉ ุงูุฃุฌูุฒุฉ ุงููุญุฐููุฉ ูุงุญูุงู (Restore)
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุชุณุงุนุฏ ุงููุฏูุฑ

### 4. **ุณูููุฉ ุงูุตูุงูุฉ**
- ุงูุจูุงูุงุช ุงููุญุฐููุฉ ุจู Soft Delete ูููู ุงุณุชุนุงุฏุชูุง
- ูููุด ููุฏุงู ููุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ
- ุงูุชูุงุฑูุฑ ุงููุฏููุฉ ุชูุถู ุชุดุชุบู

## ููุงุญุธุงุช ูููุฉ

- **Soft Delete**: ุงูุจูุงูุงุช ุชุชุญุฐู ูู ุงููุงุฌูุฉ ุจุณ ุชูุถู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **Active Booking**: ุงูุญุฌุฒ ุงููู `status = 1` (ุดุบุงู ุญุงููุงู)
- **ุงูุชูุงุฑูุฑ**: ูุด ุจุชุชุฃุซุฑ ูุฃู ุงูุจูุงูุงุช ูุณู ููุฌูุฏุฉ
- **ุงูุงุณุชุนุงุฏุฉ**: ูููู ุงุณุชุนุงุฏุฉ ุฃู ุญุงุฌุฉ ุงุชุญุฐูุช ุจู Soft Delete

ูุฐุง ุงููุธุงู ูุถูู ุงุณุชูุฑุงุฑ ุงูุนูููุงุช ูุญูุงูุฉ ุงูุจูุงูุงุช ุงููุงููุฉ ูุน ุชูููุฑ ูุฑููุฉ ูู ุงูุฅุฏุงุฑุฉ.

## ููุฎุต ุงูุชุทุจูู ุนูู DeviceTime

### โ **ุชู ุชุทุจูู ููุณ ุงูููุทู**:
1. **DeviceTime ูุณุชุฎุฏู ูู ุญุฌูุฒุงุช ูุดุทุฉ** โ โ ููุน ุงูุญุฐู
2. **DeviceTime ูุด ูุณุชุฎุฏู ูู ุญุฌูุฒุงุช ูุดุทุฉ** โ โ Soft Delete
3. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ** ุชุฎุจุฑ ุงููุณุชุฎุฏู ุจุนุฏุฏ ุงูุญุฌูุฒุงุช ุงููุดุทุฉ
4. **ุญูุงูุฉ ุงูุชูุงุฑูุฑ ุงููุงููุฉ** ูุฃู ุงูุจูุงูุงุช ุชูุถู ููุฌูุฏุฉ ุจู Soft Delete

### ๐ง **ุงููููุงุช ุงููุญุฏุซุฉ**:
- `app/Models/Device/DeviceTime/DeviceTime.php` - ุฅุถุงูุฉ methods ููุชุญูู
- `app/Services/Device/DeviceTime/DeviceTimeService.php` - ุชุญุฏูุซ ููุทู ุงูุญุฐู
- `ูุธุงู_ุงูุญุฐู_ุงูุฐูู.md` - ุชุญุฏูุซ ุงูุชูุซูู

ุงูุขู ุงููุธุงู ูุงูู ููุชุณู ุนุจุฑ ุฌููุน ุงูููููุงุช! ๐ฏ